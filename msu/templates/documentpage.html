<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MSU</title>
  <link rel="shortcut icon" href="{{url_for('static', filename='appIcon.png')}}">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons">
  <link rel="stylesheet" href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css" integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX" crossorigin="anonymous">
  {{ simplemde.css }}
  {{ simplemde.js }}

</head>

<style type="text/css">
  .body-format {
        background-color: #f2f2f2; 
        font-family: 'Trebuchet MS', Helvetica, sans-serif;
    }

    .card-format {
        height: 90vh;
        overflow: auto;
    }

    .row {
      margin: 0 auto;
    }
</style>

<body class="body-format">
  {% include "navbar.html" %}

  <div class="container-fluid to-show">

    <div class="row container-fluid">

      <div class="card col-5 card-format">
        <div class="card-header"><h2>Upload a document</h2></div>
          <div class="card-body col-sm-12">
          <form method="post">
            <input type="hidden" value="add" id="form_type" name="form_type">

            <div class="form-group">
              <label for="file" class="label">File (Allowed file types: txt, pdf, png, jpg, jpeg, gif)</label>
              <input type="file" name="file" id="file" required>
            </div>

            <div class="form-group">
              <label for="filename" class="label">Filename (Do not include file extension)</label>
              <input type="text" class="form-control" name="filename" id="filename" required>
            </div>

            <div class="form-group">
              <label for="author" class="label">Author</label>
              <input type="text" class="form-control" value="{{g.username}}" name="author" id="author" required>
            </div>

            <div class="form-group">
              <label for="editor" class="label">Description</label>
              <textarea id="editor" name="description" class="form-control" rows="4" cols="50" style="resize:none;white-space: pre-wrap" required></textarea>
            </div>

            <div class="form-group form-check">
              <input type="checkbox" class="form-check-input" name="notif" id="notif">
              <label for="notif" class="form-check-label">Notification</label>
            </div>

            <input type="submit" class="btn btn-raised btn-primary" value="Submit">
          </form>
        </div>
      </div>

      <div class="card col-7 card-format">
        <div class="card-header"><h2>Uploaded documents</h2></div>
          <div class="card-body col-sm-12">
          {% block content %}
            {% if myFiles %}
              {% for row in myFiles%}

                <form method="post">
                  
                  <div class="form-group">
                    <label for="time" class="label">Time</label>
                    <input type="text" class="form-control" value="{{row.uploadtime}}" name="time" id="time" readonly>
                  </div>

                  <div class="form-group">
                    <label for="title" class="label">Filename</label>
                    <input type="text" class="form-control" value="{{row.filename}}" name="filename" id="filename" readonly>
                  </div>

                  <div class="form-group">
                    <label for="file" class="label">Download File</label>
                    <a href="{{row.file_url}}" download="{{row.filename}}">Download</a>
                  </div>

                  <div class="form-group">
                    <label for="author" class="label">Author</label>
                    <input type="text" class="form-control" value="{{row.author}}" name="author" id="author" readonly>
                  </div>

                  <div class="form-group">
                    <label for="description" class="label">Description</label>
                    <div id="{{row.id}}"></div>
                  </div>
                  
                    <input type="submit" class="btn btn-primary" value="Delete" name="submit">
                    <input type="hidden" value="{{row.id}}" name="id">
                    <input type="hidden" value="delete" id="form_type" name="form_type">
                </form>

              {% endfor %}
            {% else %}
              <div>No documents were found in the database.</div>
            {% endif %}
          {% endblock content %}
        </div>
      </div>
    </div>
  </div>

  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js" integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js" integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9" crossorigin="anonymous"></script>
    <script>$(document).ready(function() { $('body').bootstrapMaterialDesign(); });</script>

    <script type="text/javascript">
      var simplemde = new SimpleMDE({});

      {% for row in myFiles %}

        var markdownText = `{{row.text}}`;
        $('#{{row.id}}').wrapInner(simplemde.options.previewRender(markdownText));

      {% endfor %}
    </script>
</body>
</html>
